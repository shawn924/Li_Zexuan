--1. Retrieve first 10 rows
select * from dutchairport limit 10;

--2. Filtering - find all commerical flights during 2021-2024
select sum(commercial_flights)
from dutchairport d
where periods in ('2021','2022','2023','2024') and d.airport = 'Total Dutch airports';

--annual summary
select
	periods,
	sum(cross_country_flights) as total_cross_country_flights,
	sum(local_flights) as total_local_flights,
	sum(commercial_flights) as total_commercial_flights,
	sum(scheduled_flights) as total_scheduled_flights,
	sum(passenger) as total_passenger,
	sum(cargo) as total_cargo,
	sum(mail) as total_mail
from dutchairport
where airport = 'Total Dutch airports' and periods in ('2021','2022','2023','2024')
group by periods
order by periods


--calculating year-over-year growth rates of commercial flights and passenger
with year_totals as (
	select
		periods,
		sum(commercial_flights) as total_commercial_flights,
		sum(passenger) as total_passenger
	from dutchairport
	where airport = 'Total Dutch airports' and periods in ('2020','2021','2022','2023','2024')
	group by periods
	order by periods
)
select 
	periods,
	total_commercial_flights,
	round((total_commercial_flights-lag(total_commercial_flights) over (order by periods)) * 100 / nullif(lag(total_commercial_flights) over (order by periods),0),2) as commercial_flights_growth_pct,
	total_passenger,
	round((total_passenger-lag(total_passenger) over (order by periods)) * 100 / nullif(lag(total_passenger) over (order by periods),0),2) as passenger_growth_pct
from year_totals
order by periods;

--52% growth in commerical flights from 2021-2022,and 110% growth in passenger from 2021-2022
